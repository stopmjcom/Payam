<!doctype html>
<html lang="fa" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù¾ÛŒØ§Ù… Ù†ÛŒÙˆØ² - Ø§Ø®Ø¨Ø§Ø± Ù…Ø¯Ø±Ø³Ù‡</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='45' fill='url(%23grad)'/%3E%3Cpath d='M25 25 L25 75 M25 25 L55 25 Q70 25 70 40 Q70 55 55 55 L25 55' stroke='white' stroke-width='8' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E">
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Vazir', 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100%;
            line-height: 1.6;
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .logo-text h1 {
            margin: 0;
            font-size: 28px;
            font-weight: bold;
        }

        .logo-text p {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-item {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .nav-item.active {
            background: rgba(255,255,255,0.3);
        }

        /* Theme Toggle Slider */
        .theme-toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-right: 15px;
        }

        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        .theme-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .theme-toggle.dark .theme-slider {
            transform: translateX(30px);
            background: #1e293b;
        }

        /* Main Content */
        .main-content {
            padding: 40px 0;
            min-height: 60%;
        }

        /* Login Form */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50%;
            padding: 40px 0;
        }

        .login-form {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-form h2 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .login-form .form-group {
            margin-bottom: 20px;
            text-align: right;
        }

        .login-form input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        .login-form input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Article Management */
        .admin-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .admin-panel h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 24px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        /* Enhanced File Upload with Drag & Drop */
        .file-upload-section {
            border: 3px dashed #667eea;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            position: relative;
        }

        .file-upload-section.drag-over {
            border-color: #28a745;
            background: linear-gradient(135deg, #f0fff4 0%, #dcfce7 100%);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #667eea;
        }

        .upload-text {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .upload-subtext {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
        }

        .file-input-hidden {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .thumbnail-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .thumbnail-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .thumbnail-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .thumbnail-item img,
        .thumbnail-item video {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .thumbnail-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .thumbnail-item:hover .thumbnail-overlay {
            opacity: 1;
        }

        .thumbnail-remove {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .thumbnail-remove:hover {
            background: #ff5252;
            transform: scale(1.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-success:hover {
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        /* Articles Display */
        .articles-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .articles-section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 24px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .article-card {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            background: #fafbfc;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: block;
            text-decoration: none;
            color: inherit;
        }

        .article-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: var(--bg-image);
            background-size: cover;
            background-position: center;
            opacity: 0.08;
            z-index: 1;
            border-radius: 12px;
        }

        .article-card.has-thumbnail::before {
            opacity: 0.12;
        }

        .article-card > * {
            position: relative;
            z-index: 2;
        }

        .article-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .article-card.featured {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
        }

        .article-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .article-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin: 0 0 10px 0;
        }

        .article-meta {
            font-size: 12px;
            color: #666;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .article-summary {
            color: #555;
            margin: 15px 0;
            font-size: 14px;
        }

        .article-content {
            color: #444;
            line-height: 1.8;
            margin: 15px 0;
        }

        .article-media {
            margin: 15px 0;
        }

        .article-media img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .article-media video {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .article-attachments {
            margin: 10px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .article-attachments h5 {
            margin: 0 0 6px 0;
            color: #667eea;
            font-size: 14px;
        }

        .attachment-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .attachment-item {
            display: inline-block;
            max-width: 80px;
            text-align: center;
        }

        .attachment-item img,
        .attachment-item video {
            width: 60px;
            height: 45px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 2px;
        }

        .attachment-item .file-icon {
            width: 60px;
            height: 45px;
            background: #e9ecef;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 2px;
        }

        .attachment-item .file-name {
            font-size: 10px;
            color: #666;
            word-break: break-all;
            line-height: 1.2;
            max-height: 24px;
            overflow: hidden;
        }

        .article-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 14px;
        }

        /* Full Screen Article Modal */
        .fullscreen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
            box-sizing: border-box;
        }

        .fullscreen-article {
            background: white;
            border-radius: 15px;
            padding: 40px;
            max-width: 900px;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        .fullscreen-article::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: var(--fullscreen-bg-image);
            background-size: cover;
            background-position: center;
            opacity: 0.05;
            z-index: 1;
            border-radius: 15px;
            pointer-events: none;
        }

        .fullscreen-article.has-background::before {
            opacity: 0.08;
        }

        .fullscreen-article > * {
            position: relative;
            z-index: 2;
        }

        @keyframes modalSlideIn {
            from { 
                opacity: 0; 
                transform: scale(0.9) translateY(50px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }

        .fullscreen-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .fullscreen-close:hover {
            background: #ff5252;
            transform: scale(1.1);
        }

        .fullscreen-article h1 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 28px;
            line-height: 1.4;
        }

        .fullscreen-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e1e5e9;
            font-size: 14px;
            color: #666;
            flex-wrap: wrap;
        }

        .fullscreen-content {
            font-size: 16px;
            line-height: 1.8;
            color: #333;
        }

        .fullscreen-media {
            margin: 20px 0;
        }

        .fullscreen-media img,
        .fullscreen-media video {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        /* Footer */
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
        }

        .footer p {
            margin: 0;
            opacity: 0.9;
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e6ed;
        }

        .dark-mode .header {
            background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
        }

        .dark-mode .login-form,
        .dark-mode .admin-panel,
        .dark-mode .articles-section {
            background: #1e293b;
            border: 1px solid #334155;
        }

        .dark-mode .article-card {
            background: #1e293b;
            border-color: #334155;
        }

        .dark-mode .article-card:hover {
            border-color: #667eea;
            background: #2d3748;
        }

        .dark-mode .article-card.featured {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-color: #ffd700;
        }

        .dark-mode .form-group input,
        .dark-mode .form-group textarea,
        .dark-mode .form-group select {
            background: #2d3748;
            border-color: #4a5568;
            color: #e0e6ed;
        }

        .dark-mode .form-group input:focus,
        .dark-mode .form-group textarea:focus,
        .dark-mode .form-group select:focus {
            border-color: #667eea;
        }

        .dark-mode .file-upload-section {
            background: linear-gradient(135deg, #2d3748 0%, #1e293b 100%);
            border-color: #667eea;
        }

        .dark-mode .thumbnail-item {
            background: #2d3748;
        }

        .dark-mode .article-title {
            color: #e0e6ed;
        }

        .dark-mode .article-meta {
            color: #94a3b8;
        }

        .dark-mode .article-summary {
            color: #cbd5e1;
        }

        .dark-mode .article-content {
            color: #e0e6ed;
        }

        .dark-mode .empty-state {
            color: #94a3b8;
        }

        .dark-mode .empty-state h3 {
            color: #667eea;
        }

        .dark-mode .footer {
            background: #0f172a;
        }

        .dark-mode .confirmation-dialog {
            background: #1e293b;
            border: 1px solid #334155;
        }

        .dark-mode .confirmation-dialog h3 {
            color: #667eea;
        }

        .dark-mode .confirmation-dialog p {
            color: #cbd5e1;
        }

        .dark-mode .article-attachments {
            background: #2d3748;
        }

        .dark-mode .message.success {
            background: #065f46;
            color: #d1fae5;
            border-color: #047857;
        }

        .dark-mode .message.error {
            background: #7f1d1d;
            color: #fecaca;
            border-color: #dc2626;
        }

        .dark-mode .fullscreen-article {
            background: #1e293b;
            color: #e0e6ed;
        }

        .dark-mode .fullscreen-article::before {
            opacity: 0.03;
        }

        .dark-mode .fullscreen-article.has-background::before {
            opacity: 0.06;
        }

        .dark-mode .fullscreen-article h1 {
            color: #667eea;
        }

        .dark-mode .fullscreen-meta {
            color: #94a3b8;
            border-color: #334155;
        }

        .dark-mode .fullscreen-content {
            color: #e0e6ed;
        }

        /* File Management Styles */
        .file-management {
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
        }

        .file-management h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .file-management p {
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .dark-mode .file-management {
            background: #2d3748;
            border-color: #667eea;
        }

        .dark-mode .file-management p {
            color: #cbd5e1;
        }

        /* Image Gallery Styles */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .gallery-image {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .gallery-image:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .gallery-image img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }

        .gallery-image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-image:hover .gallery-image-overlay {
            opacity: 1;
        }

        .gallery-zoom-icon {
            color: white;
            font-size: 24px;
        }

        /* Image Lightbox */
        .image-lightbox {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
            box-sizing: border-box;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .lightbox-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .lightbox-close:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .lightbox-nav:hover {
            background: rgba(255,255,255,0.3);
        }

        .lightbox-prev {
            left: -70px;
        }

        .lightbox-next {
            right: -70px;
        }

        .lightbox-counter {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
            }

            .fullscreen-article {
                padding: 20px;
                margin: 10px;
            }

            .thumbnail-preview {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }

        /* Page Content */
        .page-content {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        /* Success/Error Messages */
        .message {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Confirmation Dialog */
        .confirmation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .confirmation-dialog {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .confirmation-dialog h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .confirmation-dialog p {
            color: #666;
            margin-bottom: 25px;
        }

        .confirmation-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Header -->
  <header class="header">
   <div class="container">
    <div class="header-content">
     <div class="logo">
      <div class="logo-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
        <defs>
            <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
            </linearGradient>
        </defs>
        <circle cx="50" cy="50" r="45" fill="url(#grad)"/>
        <path d="M25 25 L25 75 M25 25 L55 25 Q70 25 70 40 Q70 55 55 55 L25 55"
              stroke="white" stroke-width="8" fill="none"
              stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
</div>

      <div class="logo-text">
       <h1 id="site-title">Ù¾ÛŒØ§Ù… Ù†ÛŒÙˆØ²</h1>
       <p id="site-tagline">Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø± Ù…Ø¯Ø±Ø³Ù‡</p>
      </div>
     </div>
     <nav class="nav-menu"><a href="#" class="nav-item active" onclick="showPage('home')">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a> <a href="#" class="nav-item" onclick="showPage('admin')">Ù…Ø¯ÛŒØ±ÛŒØª</a>
      <div class="theme-toggle-container"><button class="theme-toggle" onclick="toggleTheme()" title="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª">
        <div class="theme-slider"><span id="theme-icon">ğŸŒ™</span>
        </div></button>
      </div>
     </nav>
    </div>
   </div>
  </header><!-- Main Content -->
  <main class="main-content">
   <div class="container"><!-- Home Page -->
    <div id="home-page" class="page-content"><!-- Articles Section -->
     <div class="articles-section">
      <h2>Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø±</h2>
      <div id="articles-container">
       <div class="empty-state">
        <h3>Ù‡Ù†ÙˆØ² Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ù…Ù†ØªØ´Ø± Ù†Ø´Ø¯Ù‡</h3>
        <p>Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ù‚Ø§Ù„Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø±ÙˆÛŒØ¯</p>
       </div>
      </div>
     </div>
    </div><!-- Admin Page -->
    <div id="admin-page" class="page-content" style="display: none;"><!-- Login Form -->
     <div id="admin-login" class="login-container">
      <div class="login-form">
       <h2>ğŸ” ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
       <div id="login-message-container"></div>
       <form id="login-form">
        <div class="form-group"><input type="password" id="admin-password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
        </div><button type="submit" class="btn">ÙˆØ±ÙˆØ¯</button>
       </form>
      </div>
     </div><!-- Admin Panel -->
     <div id="admin-panel" style="display: none;"><!-- File Management Section -->
      <div class="file-management">
       <h3>ğŸ“ Ù…Ø¯ÛŒØ±ÛŒØª ÙØ§ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h3>
       <p>Ø¨Ø±Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ù‚Ø§Ù„Ø§ØªØŒ ÙØ§ÛŒÙ„ JSON Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒØŒ ÙØ§ÛŒÙ„ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯.</p>
       <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;"><button class="btn btn-success" onclick="exportArticles()">ğŸ’¾ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ JSON</button> <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importArticles(event)"> <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">ğŸ“ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„ JSON</button>
       </div>
      </div>
      <div class="admin-panel">
       <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
        <h2>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ù‚Ø§Ù„Ø§Øª</h2><button class="btn btn-secondary" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
       </div>
       <div id="message-container"></div>
       <form id="article-form">
        <div class="form-group"><label for="article-title">Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡:</label> <input type="text" id="article-title" required>
        </div>
        <div class="form-group"><label for="article-content">Ù…Ø­ØªÙˆØ§ÛŒ Ú©Ø§Ù…Ù„ Ù…Ù‚Ø§Ù„Ù‡:</label> <textarea id="article-content" placeholder="Ù…Ø­ØªÙˆØ§ÛŒ Ú©Ø§Ù…Ù„ Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." required></textarea>
        </div>
        <div class="form-group"><label for="article-author">Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡:</label> <input type="text" id="article-author" placeholder="Ù†Ø§Ù… Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡" required>
        </div><!-- Article Thumbnail Upload Section -->
        <div class="form-group"><label>ØªØµØ§ÙˆÛŒØ± Ù…Ù‚Ø§Ù„Ù‡ (Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…Ù‚Ø§Ù„Ù‡):</label>
         <div class="file-upload-section" id="image-upload-area"><input type="file" class="file-input-hidden" id="image-input" multiple accept="image/*">
          <div class="upload-icon">
           ğŸ–¼ï¸
          </div>
          <div class="upload-text">
           ØªØµØ§ÙˆÛŒØ± Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ú©Ø´ÛŒØ¯ ÛŒØ§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
          </div>
          <div class="upload-subtext">
           ÙÙ‚Ø· ØªØµØ§ÙˆÛŒØ± Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ (JPG, PNG, GIF)
          </div>
          <div class="thumbnail-preview" id="image-preview"></div>
         </div>
        </div><!-- Enhanced File Upload Section -->
        <div class="form-group"><label>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¶Ù…ÛŒÙ…Ù‡:</label>
         <div class="file-upload-section" id="file-upload-area"><input type="file" class="file-input-hidden" id="file-input" multiple accept="image/*,video/mp4,video/webm,video/ogg,.pdf,.doc,.docx">
          <div class="upload-icon">
           ğŸ“
          </div>
          <div class="upload-text">
           ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ú©Ø´ÛŒØ¯ ÛŒØ§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
          </div>
          <div class="upload-subtext">
           ØªØµØ§ÙˆÛŒØ±ØŒ ÙˆÛŒØ¯ÛŒÙˆ (MP4, WebM, OGG), PDF Ùˆ Ø§Ø³Ù†Ø§Ø¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
          </div>
          <div class="thumbnail-preview" id="thumbnail-preview"></div>
         </div>
        </div>
        <div class="form-group">
         <div class="checkbox-group"><input type="checkbox" id="article-featured"> <label for="article-featured">Ù…Ù‚Ø§Ù„Ù‡ ÙˆÛŒÚ˜Ù‡ (Ø¯Ø± ØµÙØ­Ù‡ Ø§ÙˆÙ„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯)</label>
         </div>
        </div><button type="submit" class="btn" id="submit-btn"> <span id="submit-text">Ø§Ù†ØªØ´Ø§Ø± Ù…Ù‚Ø§Ù„Ù‡</span> <span id="submit-loading" class="loading" style="display: none;"></span> </button> <button type="button" class="btn btn-secondary" id="cancel-edit-btn" style="display: none;">Ù„ØºÙˆ ÙˆÛŒØ±Ø§ÛŒØ´</button>
       </form>
      </div><!-- Published Articles Management -->
      <div class="articles-section">
       <h2>Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡</h2>
       <div id="admin-articles-container">
        <div class="empty-state">
         <h3>Ù‡Ù†ÙˆØ² Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ù…Ù†ØªØ´Ø± Ù†Ø´Ø¯Ù‡</h3>
         <p>Ø§ÙˆÙ„ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ø² ÙØ±Ù… Ø¨Ø§Ù„Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </main><!-- Footer -->
  <footer class="footer">
   <div class="container">
    <p id="footer-text">Â© 1404 Ù¾ÛŒØ§Ù… Ù†ÛŒÙˆØ² - ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª</p>
   </div>
  </footer><!-- Full Screen Article Modal -->
  <div id="fullscreen-overlay" class="fullscreen-overlay" style="display: none;">
   <div class="fullscreen-article"><button class="fullscreen-close" onclick="closeFullscreen()">Ã—</button>
    <div id="fullscreen-content"></div>
   </div>
  </div><!-- Confirmation Dialog -->
  <div id="confirmation-overlay" class="confirmation-overlay" style="display: none;">
   <div class="confirmation-dialog">
    <h3>ØªØ£ÛŒÛŒØ¯ Ø­Ø°Ù</h3>
    <p>Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ</p>
    <div class="confirmation-actions"><button class="btn btn-danger" id="confirm-delete-btn">Ø­Ø°Ù</button> <button class="btn btn-secondary" onclick="hideConfirmation()">Ù„ØºÙˆ</button>
    </div>
   </div>
  </div><!-- Image Lightbox -->
  <div id="image-lightbox" class="image-lightbox" style="display: none;">
   <div class="lightbox-content"><button class="lightbox-close" onclick="closeLightbox()">Ã—</button> <button class="lightbox-nav lightbox-prev" onclick="previousImage()" style="display: none;">â€¹</button> <img id="lightbox-image" class="lightbox-image" src="" alt=""> <button class="lightbox-nav lightbox-next" onclick="nextImage()" style="display: none;">â€º</button>
    <div class="lightbox-counter" id="lightbox-counter" style="display: none;"></div>
   </div>
  </div>
  <script>
        // Configuration object for Element SDK
        const defaultConfig = {
            site_title: "Ù¾ÛŒØ§Ù… Ù†ÛŒÙˆØ²",
            site_tagline: "Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø± Ù…Ø¯Ø±Ø³Ù‡", 
            footer_text: "Â© Û±Û´Û°Û³ Ù¾ÛŒØ§Ù… Ù†ÛŒÙˆØ² - ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª"
        };

        // Global variables
        let articles = [];
        let editingArticleId = null;
        let currentPage = 'home';
        let isLoggedIn = false;
        let deleteArticleId = null;
        let uploadedFiles = [];
        let uploadedImages = []; // Separate array for article thumbnails

        // Admin password
        const ADMIN_PASSWORD = 'mjcom';

        // Show specific page
        function showPage(pageId) {
            // Update navigation active state
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Hide all pages
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => page.style.display = 'none');
            
            // Show selected page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.style.display = 'block';
                currentPage = pageId;
                
                // Update active nav item
                const navItem = document.querySelector(`[onclick="showPage('${pageId}')"]`);
                if (navItem) {
                    navItem.classList.add('active');
                }
                
                // Handle admin page
                if (pageId === 'admin') {
                    if (isLoggedIn) {
                        document.getElementById('admin-login').style.display = 'none';
                        document.getElementById('admin-panel').style.display = 'block';
                    } else {
                        document.getElementById('admin-login').style.display = 'flex';
                        document.getElementById('admin-panel').style.display = 'none';
                    }
                }
            }
        }

        // Login functionality
        function handleLogin(event) {
            event.preventDefault();
            const password = document.getElementById('admin-password').value;
            const messageContainer = document.getElementById('login-message-container');
            
            if (password === ADMIN_PASSWORD) {
                isLoggedIn = true;
                document.getElementById('admin-login').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('admin-password').value = '';
                messageContainer.innerHTML = '';
            } else {
                messageContainer.innerHTML = '<div class="message error">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª</div>';
                setTimeout(() => {
                    messageContainer.innerHTML = '';
                }, 3000);
            }
        }

        // Logout functionality
        function logout() {
            isLoggedIn = false;
            document.getElementById('admin-login').style.display = 'flex';
            document.getElementById('admin-panel').style.display = 'none';
            resetForm();
        }

        // File upload and drag & drop functionality
        function initializeFileUpload() {
            const fileInput = document.getElementById('file-input');
            const uploadArea = document.getElementById('file-upload-area');
            const thumbnailPreview = document.getElementById('thumbnail-preview');

            const imageInput = document.getElementById('image-input');
            const imageUploadArea = document.getElementById('image-upload-area');
            const imagePreview = document.getElementById('image-preview');

            // File input change
            fileInput.addEventListener('change', handleFileSelect);
            imageInput.addEventListener('change', handleImageSelect);

            // Drag and drop events for files
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleFileDrop);

            // Drag and drop events for images
            imageUploadArea.addEventListener('dragover', handleImageDragOver);
            imageUploadArea.addEventListener('dragleave', handleImageDragLeave);
            imageUploadArea.addEventListener('drop', handleImageDrop);

            function handleFileSelect(event) {
                const files = Array.from(event.target.files);
                processFiles(files);
            }

            function handleImageSelect(event) {
                const files = Array.from(event.target.files);
                processImages(files);
            }

            function handleDragOver(event) {
                event.preventDefault();
                uploadArea.classList.add('drag-over');
            }

            function handleDragLeave(event) {
                event.preventDefault();
                uploadArea.classList.remove('drag-over');
            }

            function handleFileDrop(event) {
                event.preventDefault();
                uploadArea.classList.remove('drag-over');
                const files = Array.from(event.dataTransfer.files);
                processFiles(files);
            }

            function handleImageDragOver(event) {
                event.preventDefault();
                imageUploadArea.classList.add('drag-over');
            }

            function handleImageDragLeave(event) {
                event.preventDefault();
                imageUploadArea.classList.remove('drag-over');
            }

            function handleImageDrop(event) {
                event.preventDefault();
                imageUploadArea.classList.remove('drag-over');
                const files = Array.from(event.dataTransfer.files);
                processImages(files);
            }

            function processFiles(files) {
                files.forEach(file => {
                    // Different size limits for different file types
                    let sizeLimit = 10 * 1024 * 1024; // 10MB default
                    if (file.type.startsWith('video/')) {
                        sizeLimit = 50 * 1024 * 1024; // 50MB for videos
                    } else if (file.type.startsWith('image/')) {
                        sizeLimit = 5 * 1024 * 1024; // 5MB for images
                    }

                    if (file.size > sizeLimit) {
                        const sizeMB = Math.round(sizeLimit / (1024 * 1024));
                        showMessage(`ÙØ§ÛŒÙ„ ${file.name} Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ø¨Ø²Ø±Ú¯ Ø§Ø³Øª (Ø­Ø¯Ø§Ú©Ø«Ø± ${sizeMB}MB)`, "error");
                        return;
                    }

                    // Check video format
                    if (file.type.startsWith('video/')) {
                        const supportedVideoTypes = ['video/mp4', 'video/webm', 'video/ogg'];
                        if (!supportedVideoTypes.includes(file.type)) {
                            showMessage(`ÙØ±Ù…Øª ÙˆÛŒØ¯ÛŒÙˆ ${file.name} Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ù„Ø·ÙØ§Ù‹ MP4, WebM ÛŒØ§ OGG Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.`, "error");
                            return;
                        }
                    }

                    const fileData = {
                        id: generateId(),
                        file: file,
                        name: file.name,
                        type: file.type,
                        url: URL.createObjectURL(file),
                        base64: null
                    };

                    // Convert to base64 for storage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        fileData.base64 = e.target.result;
                        console.log(`File ${file.name} converted to base64 successfully`);
                    };
                    reader.onerror = function(e) {
                        console.error(`Error converting ${file.name} to base64:`, e);
                        showMessage(`Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙØ§ÛŒÙ„ ${file.name}`, "error");
                    };
                    reader.readAsDataURL(file);

                    uploadedFiles.push(fileData);
                    createThumbnail(fileData);
                });
            }

            function processImages(files) {
                files.forEach(file => {
                    if (!file.type.startsWith('image/')) {
                        showMessage(`ÙØ§ÛŒÙ„ ${file.name} ÛŒÚ© ØªØµÙˆÛŒØ± Ù†ÛŒØ³Øª`, "error");
                        return;
                    }

                    if (file.size > 5 * 1024 * 1024) { // 5MB limit for images
                        showMessage(`ØªØµÙˆÛŒØ± ${file.name} Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ø¨Ø²Ø±Ú¯ Ø§Ø³Øª (Ø­Ø¯Ø§Ú©Ø«Ø± 5MB)`, "error");
                        return;
                    }

                    const imageData = {
                        id: generateId(),
                        file: file,
                        name: file.name,
                        type: file.type,
                        url: URL.createObjectURL(file),
                        base64: null
                    };

                    // Convert to base64 for storage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageData.base64 = e.target.result;
                    };
                    reader.readAsDataURL(file);

                    uploadedImages.push(imageData);
                    createImageThumbnail(imageData);
                });
            }

            function createThumbnail(fileData) {
                const thumbnailDiv = document.createElement('div');
                thumbnailDiv.className = 'thumbnail-item';
                thumbnailDiv.dataset.fileId = fileData.id;

                let content = '';
                if (fileData.type.startsWith('image/')) {
                    content = `<img src="${fileData.url}" alt="${fileData.name}" onerror="this.style.display='none';">`;
                } else if (fileData.type.startsWith('video/')) {
                    content = `
                        <div style="position: relative; height: 120px; background: #000; display: flex; align-items: center; justify-content: center;">
                            <video src="${fileData.url}" muted style="max-width: 100%; max-height: 100%; object-fit: cover;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"></video>
                            <div style="display: none; color: white; text-align: center;">
                                <div style="font-size: 24px; margin-bottom: 5px;">ğŸ¥</div>
                                <div style="font-size: 12px;">${fileData.name}</div>
                            </div>
                            <div style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">
                                ğŸ¥ ÙˆÛŒØ¯ÛŒÙˆ
                            </div>
                        </div>
                    `;
                } else {
                    content = `
                        <div style="height: 120px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; color: #666;">
                            <div style="text-align: center;">
                                <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“„</div>
                                <div style="font-size: 12px; word-break: break-all;">${fileData.name}</div>
                            </div>
                        </div>
                    `;
                }

                thumbnailDiv.innerHTML = `
                    ${content}
                    <div class="thumbnail-overlay">
                        <button class="thumbnail-remove" onclick="removeFile('${fileData.id}')">Ã—</button>
                    </div>
                `;

                thumbnailPreview.appendChild(thumbnailDiv);
            }

            function createImageThumbnail(imageData) {
                const thumbnailDiv = document.createElement('div');
                thumbnailDiv.className = 'thumbnail-item';
                thumbnailDiv.dataset.imageId = imageData.id;

                thumbnailDiv.innerHTML = `
                    <img src="${imageData.url}" alt="${imageData.name}">
                    <div class="thumbnail-overlay">
                        <button class="thumbnail-remove" onclick="removeImage('${imageData.id}')">Ã—</button>
                    </div>
                `;

                imagePreview.appendChild(thumbnailDiv);
            }
        }

        // Remove uploaded file
        function removeFile(fileId) {
            uploadedFiles = uploadedFiles.filter(file => file.id !== fileId);
            const thumbnailElement = document.querySelector(`[data-file-id="${fileId}"]`);
            if (thumbnailElement) {
                thumbnailElement.remove();
            }
        }

        // Remove uploaded image
        function removeImage(imageId) {
            uploadedImages = uploadedImages.filter(image => image.id !== imageId);
            const thumbnailElement = document.querySelector(`[data-image-id="${imageId}"]`);
            if (thumbnailElement) {
                thumbnailElement.remove();
            }
        }

        // Export articles to JSON file
        function exportArticles() {
            try {
                const dataToExport = {
                    exportDate: new Date().toISOString(),
                    version: "1.0",
                    articles: articles
                };
                
                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `payam-news-articles-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showMessage(`ÙØ§ÛŒÙ„ JSON Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯! (${articles.length} Ù…Ù‚Ø§Ù„Ù‡)`, "success");
            } catch (error) {
                showMessage("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„", "error");
            }
        }

        // Import articles from JSON file
        function importArticles(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type !== 'application/json') {
                showMessage("Ù„Ø·ÙØ§Ù‹ ÙÙ‚Ø· ÙØ§ÛŒÙ„ JSON Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯", "error");
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.articles || !Array.isArray(importedData.articles)) {
                        showMessage("ÙØ±Ù…Øª ÙØ§ÛŒÙ„ JSON Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª", "error");
                        return;
                    }
                    
                    const validArticles = importedData.articles.filter(article => {
                        return article.id && article.title && article.content && article.author;
                    });
                    
                    if (validArticles.length === 0) {
                        showMessage("Ù‡ÛŒÚ† Ù…Ù‚Ø§Ù„Ù‡ Ù…Ø¹ØªØ¨Ø±ÛŒ Ø¯Ø± ÙØ§ÛŒÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯", "error");
                        return;
                    }
                    
                    articles = validArticles;
                    renderArticles();
                    renderAdminArticles();
                    
                    showMessage(`${validArticles.length} Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯!`, "success");
                    event.target.value = '';
                    
                } catch (error) {
                    showMessage("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ JSON", "error");
                }
            };
            
            reader.readAsText(file);
        }

        // Open article in fullscreen
        function openFullscreen(articleId) {
            const article = articles.find(a => a.id === articleId);
            if (!article) return;

            const overlay = document.getElementById('fullscreen-overlay');
            const content = document.getElementById('fullscreen-content');
            const fullscreenArticle = overlay.querySelector('.fullscreen-article');

            const mediaHTML = createMediaHTML(article);
            const attachmentsHTML = createAttachmentsHTML(article, true);

            // Get thumbnail for background
            let thumbnailUrl = '';
            let hasThumb = false;
            if (article.images && article.images.length > 0) {
                thumbnailUrl = article.images[0].data;
                hasThumb = true;
            } else if (article.attachments && article.attachments.length > 0) {
                const imageAttachment = article.attachments.find(att => att.type.startsWith('image/'));
                if (imageAttachment) {
                    thumbnailUrl = imageAttachment.data;
                    hasThumb = true;
                }
            }

            // Apply background to fullscreen article
            if (hasThumb) {
                fullscreenArticle.classList.add('has-background');
                fullscreenArticle.style.setProperty('--fullscreen-bg-image', `url('${thumbnailUrl}')`);
            } else {
                fullscreenArticle.classList.remove('has-background');
                fullscreenArticle.style.removeProperty('--fullscreen-bg-image');
            }

            content.innerHTML = `
                <h1>${article.title}</h1>
                <div class="fullscreen-meta">
                    <span>Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: ${article.author}</span>
                    <span>ØªØ§Ø±ÛŒØ®: ${formatPersianDate(new Date(article.publishDate))}</span>
                    ${article.featured ? '<span style="color: #ffd700; font-weight: bold;">â­ Ù…Ù‚Ø§Ù„Ù‡ ÙˆÛŒÚ˜Ù‡</span>' : ''}
                </div>
                <div class="fullscreen-content">${article.content}</div>
                ${mediaHTML ? `<div class="fullscreen-media">${mediaHTML}</div>` : ''}
                ${attachmentsHTML}
            `;

            overlay.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Close fullscreen
        function closeFullscreen() {
            document.getElementById('fullscreen-overlay').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Create article HTML
        function createArticleHTML(article, showActions = true) {
            const mediaHTML = createMediaHTML(article);
            const attachmentsHTML = showActions ? createAttachmentsHTML(article, true) : '';
            
            // Get thumbnail for background
            let thumbnailUrl = '';
            let hasThumb = false;
            if (article.images && article.images.length > 0) {
                thumbnailUrl = article.images[0].data;
                hasThumb = true;
            } else if (article.attachments && article.attachments.length > 0) {
                const imageAttachment = article.attachments.find(att => att.type.startsWith('image/'));
                if (imageAttachment) {
                    thumbnailUrl = imageAttachment.data;
                    hasThumb = true;
                }
            }
            
            return `
                <div class="article-card ${article.featured ? 'featured' : ''} ${hasThumb ? 'has-thumbnail' : ''}" 
                     data-article-id="${article.id}" 
                     ${hasThumb ? `style="--bg-image: url('${thumbnailUrl}')"` : ''}>
                    <div class="article-header">
                        <div>
                            <h3 class="article-title">${article.title}</h3>
                            <div class="article-meta">
                                <span>Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: ${article.author}</span>
                                <span>ØªØ§Ø±ÛŒØ®: ${formatPersianDate(new Date(article.publishDate))}</span>
                                ${article.featured ? '<span style="color: #ffd700; font-weight: bold;">â­ Ù…Ù‚Ø§Ù„Ù‡ ÙˆÛŒÚ˜Ù‡</span>' : ''}
                            </div>
                        </div>
                    </div>

                    ${!showActions ? '' : `<div class="article-content">${article.content}</div>`}
                    ${showActions ? mediaHTML : ''}
                    ${attachmentsHTML}
                    ${showActions ? `
                        <div class="article-actions">
                            <button class="btn btn-small" onclick="event.stopPropagation(); editArticle('${article.id}')">ÙˆÛŒØ±Ø§ÛŒØ´</button>
                            <button class="btn btn-danger btn-small" onclick="event.stopPropagation(); showDeleteConfirmation('${article.id}')">Ø­Ø°Ù</button>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Create media HTML
        function createMediaHTML(article) {
            let mediaHTML = '';
            
            // Display article images in gallery format
            if (article.images && Array.isArray(article.images) && article.images.length > 0) {
                mediaHTML += `
                    <div class="image-gallery">
                        ${article.images.map((image, index) => `
                            <div class="gallery-image" onclick="openLightbox('${article.id}', ${index})">
                                <img src="${image.data}" alt="${image.name}" onerror="this.parentElement.style.display='none';">
                                <div class="gallery-image-overlay">
                                    <span class="gallery-zoom-icon">ğŸ”</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            if (article.videoUrl) {
                mediaHTML += `
                    <div class="article-media">
                        <video controls preload="metadata" muted onerror="this.style.display='none';">
                            <source src="${article.videoUrl}" type="video/mp4">
                            Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ø§ÛŒÙ† ÙØ±Ù…Øª ÙˆÛŒØ¯ÛŒÙˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
                        </video>
                    </div>
                `;
            }
            
            return mediaHTML;
        }

        // Create attachments HTML
        function createAttachmentsHTML(article, showAttachments = true) {
            if (!showAttachments || !article.attachments || !Array.isArray(article.attachments) || article.attachments.length === 0) return '';
            
            return `
                <div class="article-attachments">
                    <h5>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¶Ù…ÛŒÙ…Ù‡:</h5>
                    <div class="attachment-gallery">
                        ${article.attachments.map(attachment => {
                            if (attachment.type.startsWith('image/')) {
                                return `
                                    <div class="attachment-item">
                                        <img src="${attachment.data}" alt="${attachment.name}">
                                        <div class="file-name">${attachment.name}</div>
                                    </div>
                                `;
                            } else if (attachment.type.startsWith('video/')) {
                                return `
                                    <div class="attachment-item">
                                        <video preload="metadata" muted>
                                            <source src="${attachment.data}" type="${attachment.type}">
                                        </video>
                                        <div class="file-name">${attachment.name}</div>
                                    </div>
                                `;
                            } else {
                                return `
                                    <div class="attachment-item">
                                        <div class="file-icon">ğŸ“„</div>
                                        <div class="file-name">${attachment.name}</div>
                                    </div>
                                `;
                            }
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // Show delete confirmation
        function showDeleteConfirmation(articleId) {
            deleteArticleId = articleId;
            document.getElementById('confirmation-overlay').style.display = 'flex';
        }

        // Hide confirmation
        function hideConfirmation() {
            deleteArticleId = null;
            document.getElementById('confirmation-overlay').style.display = 'none';
        }

        // Confirm delete
        function confirmDelete() {
            if (!deleteArticleId) return;
            
            articles = articles.filter(article => article.id !== deleteArticleId);
            renderArticles();
            renderAdminArticles();
            
            showMessage("Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯", "success");
            hideConfirmation();
        }

        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const themeToggle = document.querySelector('.theme-toggle');
            
            body.classList.toggle('dark-mode');
            themeToggle.classList.toggle('dark');
            
            if (body.classList.contains('dark-mode')) {
                themeIcon.textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'dark');
            } else {
                themeIcon.textContent = 'ğŸŒ™';
                localStorage.setItem('theme', 'light');
            }
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const themeToggle = document.querySelector('.theme-toggle');
            
            if (savedTheme === 'dark') {
                body.classList.add('dark-mode');
                themeToggle.classList.add('dark');
                themeIcon.textContent = 'â˜€ï¸';
            } else {
                body.classList.remove('dark-mode');
                themeToggle.classList.remove('dark');
                themeIcon.textContent = 'ğŸŒ™';
            }
        }

        // Element SDK configuration
        const elementConfig = {
            defaultConfig: defaultConfig,
            onConfigChange: async (config) => {
                const titleElement = document.getElementById('site-title');
                if (titleElement) {
                    titleElement.textContent = config.site_title || defaultConfig.site_title;
                }

                const taglineElement = document.getElementById('site-tagline');
                if (taglineElement) {
                    taglineElement.textContent = config.site_tagline || defaultConfig.site_tagline;
                }

                const footerElement = document.getElementById('footer-text');
                if (footerElement) {
                    footerElement.textContent = config.footer_text || defaultConfig.footer_text;
                }
            },
            mapToCapabilities: (config) => ({
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            }),
            mapToEditPanelValues: (config) => new Map([
                ["site_title", config.site_title || defaultConfig.site_title],
                ["site_tagline", config.site_tagline || defaultConfig.site_tagline],
                ["footer_text", config.footer_text || defaultConfig.footer_text]
            ])
        };

        // Initialize app
        async function initializeApp() {
            try {
                if (window.elementSdk) {
                    await window.elementSdk.init(elementConfig);
                }
            } catch (error) {
                console.error("Initialization error:", error);
            }
        }

        // Show success/error messages
        function showMessage(text, type = "success") {
            const container = document.getElementById('message-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = text;
            
            container.innerHTML = '';
            container.appendChild(messageDiv);
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        // Generate unique ID
        function generateId() {
            return Date.now().toString() + Math.random().toString(36).substr(2, 9);
        }

        // Format Persian date
        function formatPersianDate(date) {
            return new Intl.DateTimeFormat('fa-IR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            }).format(date);
        }

        // Handle form submission
        function handleFormSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('submit-btn');
            const submitText = document.getElementById('submit-text');
            const submitLoading = document.getElementById('submit-loading');
            
            submitBtn.disabled = true;
            submitText.style.display = 'none';
            submitLoading.style.display = 'inline-block';

            try {
                const title = document.getElementById('article-title').value.trim();
                const content = document.getElementById('article-content').value.trim();
                const author = document.getElementById('article-author').value.trim();
                
                if (!title || !content || !author) {
                    showMessage("Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯.", "error");
                    return;
                }

                // Process uploaded files and images
                let videoUrl = '';
                let attachments = [];
                let images = [];

                // Process attachment files
                uploadedFiles.forEach(file => {
                    if (file.type.startsWith('video/')) {
                        videoUrl = file.base64 || file.url;
                    } else {
                        attachments.push({
                            name: file.name,
                            type: file.type,
                            data: file.base64 || file.url
                        });
                    }
                });

                // Process article images
                uploadedImages.forEach(image => {
                    images.push({
                        id: image.id,
                        name: image.name,
                        type: image.type,
                        data: image.base64 || image.url
                    });
                });

                const formData = {
                    id: editingArticleId || generateId(),
                    title: title,
                    content: content,
                    author: author,
                    category: "Ø§Ø®Ø¨Ø§Ø± Ø¹Ù…ÙˆÙ…ÛŒ",
                    featured: Boolean(document.getElementById('article-featured').checked),
                    publishDate: new Date().toISOString(),
                    images: images,
                    videoUrl: videoUrl,
                    attachments: attachments
                };

                if (editingArticleId) {
                    const index = articles.findIndex(a => a.id === editingArticleId);
                    if (index !== -1) {
                        articles[index] = formData;
                        showMessage("Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯", "success");
                    }
                } else {
                    articles.push(formData);
                    showMessage("Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù…Ù†ØªØ´Ø± Ø´Ø¯", "success");
                }

                renderArticles();
                renderAdminArticles();
                resetForm();
                
            } catch (error) {
                showMessage("Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ù…Ù‚Ø§Ù„Ù‡", "error");
            } finally {
                submitBtn.disabled = false;
                submitText.style.display = 'inline';
                submitLoading.style.display = 'none';
            }
        }

        // Reset form
        function resetForm() {
            document.getElementById('article-form').reset();
            document.getElementById('thumbnail-preview').innerHTML = '';
            document.getElementById('image-preview').innerHTML = '';
            uploadedFiles = [];
            uploadedImages = [];
            editingArticleId = null;
            document.getElementById('submit-text').textContent = 'Ø§Ù†ØªØ´Ø§Ø± Ù…Ù‚Ø§Ù„Ù‡';
            document.getElementById('cancel-edit-btn').style.display = 'none';
        }

        // Edit article
        function editArticle(articleId) {
            const article = articles.find(a => a.id === articleId);
            if (!article) return;

            if (currentPage !== 'admin') {
                showPage('admin');
            }

            editingArticleId = articleId;
            
            document.getElementById('article-title').value = article.title;
            document.getElementById('article-content').value = article.content;
            document.getElementById('article-author').value = article.author;
            document.getElementById('article-featured').checked = article.featured;

            // Load existing images
            uploadedImages = [];
            if (article.images && Array.isArray(article.images)) {
                article.images.forEach(image => {
                    const imageData = {
                        id: image.id,
                        name: image.name,
                        type: image.type,
                        url: image.data,
                        base64: image.data
                    };
                    uploadedImages.push(imageData);
                    createImageThumbnailFromData(imageData);
                });
            }

            // Load existing attachments
            uploadedFiles = [];
            if (article.attachments && Array.isArray(article.attachments)) {
                article.attachments.forEach(attachment => {
                    const fileData = {
                        id: generateId(),
                        name: attachment.name,
                        type: attachment.type,
                        url: attachment.data,
                        base64: attachment.data
                    };
                    uploadedFiles.push(fileData);
                    createThumbnailFromData(fileData);
                });
            }
            
            document.getElementById('submit-text').textContent = 'Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ù‚Ø§Ù„Ù‡';
            document.getElementById('cancel-edit-btn').style.display = 'inline-block';
            
            setTimeout(() => {
                document.querySelector('.admin-panel').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Create thumbnail from existing data
        function createThumbnailFromData(fileData) {
            const thumbnailPreview = document.getElementById('thumbnail-preview');
            const thumbnailDiv = document.createElement('div');
            thumbnailDiv.className = 'thumbnail-item';
            thumbnailDiv.dataset.fileId = fileData.id;

            let content = '';
            if (fileData.type.startsWith('image/')) {
                content = `<img src="${fileData.url}" alt="${fileData.name}">`;
            } else if (fileData.type.startsWith('video/')) {
                content = `<video src="${fileData.url}" muted></video>`;
            } else {
                content = `
                    <div style="height: 120px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; color: #666;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“„</div>
                            <div style="font-size: 12px;">${fileData.name}</div>
                        </div>
                    </div>
                `;
            }

            thumbnailDiv.innerHTML = `
                ${content}
                <div class="thumbnail-overlay">
                    <button class="thumbnail-remove" onclick="removeFile('${fileData.id}')">Ã—</button>
                </div>
            `;

            thumbnailPreview.appendChild(thumbnailDiv);
        }

        // Create image thumbnail from existing data
        function createImageThumbnailFromData(imageData) {
            const imagePreview = document.getElementById('image-preview');
            const thumbnailDiv = document.createElement('div');
            thumbnailDiv.className = 'thumbnail-item';
            thumbnailDiv.dataset.imageId = imageData.id;

            thumbnailDiv.innerHTML = `
                <img src="${imageData.url}" alt="${imageData.name}">
                <div class="thumbnail-overlay">
                    <button class="thumbnail-remove" onclick="removeImage('${imageData.id}')">Ã—</button>
                </div>
            `;

            imagePreview.appendChild(thumbnailDiv);
        }

        // Render articles for home page
        function renderArticles() {
            const container = document.getElementById('articles-container');
            
            if (articles.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>Ù‡Ù†ÙˆØ² Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ù…Ù†ØªØ´Ø± Ù†Ø´Ø¯Ù‡</h3>
                        <p>Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ù‚Ø§Ù„Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø±ÙˆÛŒØ¯</p>
                    </div>
                `;
                return;
            }

            const sortedArticles = [...articles].sort((a, b) => {
                if (a.featured && !b.featured) return -1;
                if (!a.featured && b.featured) return 1;
                return new Date(b.publishDate) - new Date(a.publishDate);
            });

            container.innerHTML = sortedArticles.map(article => {
                const articleHTML = createArticleHTML(article, false);
                return `<a href="#" onclick="event.preventDefault(); openFullscreen('${article.id}')" style="text-decoration: none; color: inherit;">${articleHTML}</a>`;
            }).join('');
        }

        // Render articles for admin page
        function renderAdminArticles() {
            const container = document.getElementById('admin-articles-container');
            
            if (articles.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>Ù‡Ù†ÙˆØ² Ù…Ù‚Ø§Ù„Ù‡â€ŒØ§ÛŒ Ù…Ù†ØªØ´Ø± Ù†Ø´Ø¯Ù‡</h3>
                        <p>Ø§ÙˆÙ„ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ø² ÙØ±Ù… Ø¨Ø§Ù„Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</p>
                    </div>
                `;
                return;
            }

            const sortedArticles = [...articles].sort((a, b) => {
                if (a.featured && !b.featured) return -1;
                if (!a.featured && b.featured) return 1;
                return new Date(b.publishDate) - new Date(a.publishDate);
            });

            container.innerHTML = sortedArticles.map(article => createArticleHTML(article, true)).join('');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadTheme();
            initializeFileUpload();
            
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('article-form').addEventListener('submit', handleFormSubmit);
            document.getElementById('cancel-edit-btn').addEventListener('click', resetForm);
            document.getElementById('confirm-delete-btn').addEventListener('click', confirmDelete);

            // Close fullscreen on escape key and lightbox navigation
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeFullscreen();
                    closeLightbox();
                    hideConfirmation();
                } else if (event.key === 'ArrowLeft') {
                    previousImage();
                } else if (event.key === 'ArrowRight') {
                    nextImage();
                }
            });

            // Close fullscreen on overlay click
            document.getElementById('fullscreen-overlay').addEventListener('click', function(event) {
                if (event.target === this) {
                    closeFullscreen();
                }
            });
        });

        // Lightbox functionality
        let currentLightboxArticle = null;
        let currentImageIndex = 0;

        function openLightbox(articleId, imageIndex = 0) {
            const article = articles.find(a => a.id === articleId);
            if (!article || !article.images || article.images.length === 0) return;

            currentLightboxArticle = article;
            currentImageIndex = imageIndex;

            const lightbox = document.getElementById('image-lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxCounter = document.getElementById('lightbox-counter');
            const prevBtn = document.querySelector('.lightbox-prev');
            const nextBtn = document.querySelector('.lightbox-next');

            lightboxImage.src = article.images[imageIndex].data;
            lightboxImage.alt = article.images[imageIndex].name;

            if (article.images.length > 1) {
                lightboxCounter.textContent = `${imageIndex + 1} Ø§Ø² ${article.images.length}`;
                lightboxCounter.style.display = 'block';
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
            } else {
                lightboxCounter.style.display = 'none';
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }

            lightbox.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('image-lightbox').style.display = 'none';
            document.body.style.overflow = 'auto';
            currentLightboxArticle = null;
            currentImageIndex = 0;
        }

        function previousImage() {
            if (!currentLightboxArticle || currentLightboxArticle.images.length <= 1) return;
            
            currentImageIndex = (currentImageIndex - 1 + currentLightboxArticle.images.length) % currentLightboxArticle.images.length;
            
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxCounter = document.getElementById('lightbox-counter');
            
            lightboxImage.src = currentLightboxArticle.images[currentImageIndex].data;
            lightboxImage.alt = currentLightboxArticle.images[currentImageIndex].name;
            lightboxCounter.textContent = `${currentImageIndex + 1} Ø§Ø² ${currentLightboxArticle.images.length}`;
        }

        function nextImage() {
            if (!currentLightboxArticle || currentLightboxArticle.images.length <= 1) return;
            
            currentImageIndex = (currentImageIndex + 1) % currentLightboxArticle.images.length;
            
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxCounter = document.getElementById('lightbox-counter');
            
            lightboxImage.src = currentLightboxArticle.images[currentImageIndex].data;
            lightboxImage.alt = currentLightboxArticle.images[currentImageIndex].name;
            lightboxCounter.textContent = `${currentImageIndex + 1} Ø§Ø² ${currentLightboxArticle.images.length}`;
        }

        // Make functions globally available
        window.showPage = showPage;
        window.logout = logout;
        window.editArticle = editArticle;
        window.showDeleteConfirmation = showDeleteConfirmation;
        window.hideConfirmation = hideConfirmation;
        window.toggleTheme = toggleTheme;
        window.exportArticles = exportArticles;
        window.importArticles = importArticles;
        window.openFullscreen = openFullscreen;
        window.closeFullscreen = closeFullscreen;
        window.removeFile = removeFile;
        window.removeImage = removeImage;
        window.openLightbox = openLightbox;
        window.closeLightbox = closeLightbox;
        window.previousImage = previousImage;
        window.nextImage = nextImage;
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9965c0cb00d07fc6',t:'MTc2MTc3MzIwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>